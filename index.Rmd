---
title: "Análisis Exploratorio de Datos (EDA) de Accidentes de Tránsito en Costa Rica"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(dplyr)
library(ggplot2)
library(plotly)
library(treemapify)



setwd("~/Desktop/Proyecto1")
data <- read.csv("accidentes_transito_con_victimas_2016_2022.csv", sep = ";")
```

# Gráficas Unidimensionales
## Gráfica de Barras para Tipos de Accidentes
```{r, echo=FALSE}
barChartTipoAccidente <- ggplot(data, aes(x = Tipo.de.accidente)) +
  geom_bar(fill = "#00abff", colour = "black") + 
  theme(axis.text.x = element_text(angle = -25, hjust = 0)) + 
  labs(
    x = "Tipo de Accidente",
    y = "Frecuencia"
  )

ggplotly(barChartTipoAccidente)
```
# Treemap para cantidad de accidentes por provincia
```{r, echo=FALSE}
dfProvincia <- data %>% count(Provincia)

treeMapProvincia <- plot_ly(dfProvincia, 
                             labels = ~ Provincia, 
                             parents = NA, 
                             values = ~ n, 
                             type = "treemap", 
                             hovertemplate = "Provincia: %{label}<br>Frecuencia: %{value}")

treeMapProvincia
```

# Gráfica de Barras para Hora del Accidente
```{r, echo=FALSE}
barChartHoraAccidente <- ggplot(data, aes (x = Hora)) +
  geom_bar(fill = "#00abff", colour = "black") + 
  theme(axis.text.x = element_text(angle = -30, hjust = 0)) + 
  labs(
    x = "Hora del Accidente",
    y = "Frecuencia"
  )

ggplotly(barChartHoraAccidente)
```

# Gráficas Bidimensionales
## Gráfica de Barras Apiladas del Tipo y Clase de Accidente
```{r, echo=FALSE}
barChartTipoClaseAccidente <- ggplot(data, aes(x = Tipo.de.accidente)) +
  geom_bar(aes(fill = Clase.de.accidente)) + 
  theme(axis.text.x = element_text(angle = -25, hjust = 0)) + labs(
    x = "Tipo de Accidente",
    y = "Frecuencia", 
    fill = "Clase de Accidente"
  )

ggplotly(barChartTipoClaseAccidente)
```

## Gráfica de Barras Agrupadas del Tipo de Accidente y Tipo de Circulación
```{r, echo=FALSE}
barChartTipoAccidenteEstadoTiempo <- ggplot(data, aes(x = Tipo.de.circulación)) +
    geom_bar(aes(fill = Clase.de.accidente), position = position_dodge()) + 
  theme(axis.text.x = element_text(angle = -25, hjust = 0)) + labs(
    x = "Tipo de Accidente",
    y = "Frecuencia", 
    fill = "Tipo de Circulación"
  )

ggplotly(barChartTipoAccidenteEstadoTiempo)
```

# Gráfica Multidimensional
## Técnica de Incrustación de Dimensiones
```{r, echo=FALSE}
dfMultidimensional = data %>% count(Año, Tipo.de.accidente, Clase.de.accidente, Hora)

multidimensionalPlot <- ggplot(dfMultidimensional, aes(x = Año, 
                       y = n,
                       z = Tipo.de.accidente,
                       shape = Clase.de.accidente, 
                       color = Hora)) +
  geom_point(size = 3, alpha = .6) +
  labs (x = "Año",
        y = "Frecuencia",
        z = "Tipo de Accidente",
        shape = "(Clase de Accidente, Hora)",
        color = "")

ggplotly(multidimensionalPlot)
```

# Facetas

## Gráfica de Facetas del Año, Tipo de Accidente y la Frecuencia
```{r, echo=FALSE}
dfTipoAnno = data %>% count(Tipo.de.accidente, Año)

chart <- ggplot(dfTipoAnno, aes(Año, n)) +
  geom_line() +
  facet_wrap(~Tipo.de.accidente, ncol = 3) + 
  labs(x = "Año",
       y = "Frecuencia")

ggplotly(chart)
```
